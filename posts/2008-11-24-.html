---
layout: post
title: "画地图"
date: 2008-11-24
comments: false
---

<div class='post'>
昨天简单用 GMT 画了一个研究区域位置图，并不费劲，今天画地形图才算是费了大劲。首先是 pscoast 画的底图跟 DEM 对不上。我在 Google Earth 和 GRASS 之间来回对照没看出什么问题，后来打开经纬度网格才发现 gtopo30 中的青藏高原南边的一系列山峰跑到了北纬30度附近（实际应为27.5度左右），不知道是 gtopo30 这个数据集本身的 bug 还是 GRASS 转换格式时出的问题。<br/><br/>[caption id="" align="alignleft" width="240" caption="Topography map of Tibet"]<a title="Tibet Topography" rel="lightbox" href="http://farm4.static.flickr.com/3215/3057160904_5672415cc4_b.jpg"><img title="Tibet Topography" src="http://farm4.static.flickr.com/3215/3057160904_5672415cc4_m.jpg" alt="Topography map of Tibet" width="240" height="102" /></a>[/caption]<br/><br/>后来重新搜了一下，改用 UC San Diego 的 Smith &amp; Sandwell[1. Smith, W. H. F., and D. T. Sandwell, Global seafloor topography from satellite altimetry and ship depth soundings, Science, v. 277, p. 1957-1962, 26 Sept., 1997.] 的全球地形数据集。之后就是不断地看各个命令的 man page，以及 <a href="http://gmt.soest.hawaii.edu/gmt/doc/html/GMT_Docs/GMT_Docs.html" target="_blank">GMT Cookbook</a> 还有邮件列表和各种网站上的资料，并攻克了诸如调节调色板对应高度范围等种种难题。在这过程中我发现 GMT 虽然学习曲线相当陡峭，但并不是阳春白雪，许多大学的制图课都将其作为重要的内容。<br/><br/>绘图用的脚本如下：<br/><pre lang="bash">#/bin/bash<br/># prepare the surface<br/># data downloaded from ftp://topex.ucsd.edu/pub/global_topo_1min/<br/>img2grd ~/images/global_topo_1min/topo_11.1.img -T1 -S1 -R70/105/25/40 -m1 -D -Gtopo.nc -V<br/>mv topo.nc ~/Desktop/thesis/auxillary/topo.nc<br/># land is a home-made cpt derived from GMT_relief.cpt<br/>makecpt -Cland -T-1000/9000/1000 -Z -V > topo.cpt<br/># Relieves<br/>grdgradient ~/Desktop/thesis/auxillary/topo.nc -Ne1 -A100 -M -Glight.nc<br/>#basemap<br/>grdimage ~/Desktop/thesis/auxillary/topo.nc -Ilight.nc -Ctopo.cpt -Jm87.5/32.5/0.6c -Bpa600mg600m -R70/105/25/40 -K > ~/Desktop/thesis/images/topography.ps<br/>pscoast -Bpa600mg600mf300m -J -R -I2 -N1/thick -W -Lf77/27/33/1000 -Tf102/37/1.5c -O -K >> ~/Desktop/thesis/images/topography.ps<br/>psxy ~/Desktop/thesis/auxillary/boundary.xy -O -J -R -Sc0.03c -Gblack -K >> ~/Desktop/thesis/images/topography.ps<br/># annotations<br/>pstext -O -J -R -K >> ~/Desktop/thesis/images/topography.ps <<END<br/>75 29 18 0 1 LM @#India@%%<br/>80 39 16 0 21 LM XUAR<br/>84 33 16 0 21 LM TAR<br/>93 37 16 0 21 LM Qinghai<br/>100 30 16 0 21 LM Sichuan<br/>END<br/>pstext -O -J -R -Wwhite,Othinnest,white -K >> ~/Desktop/thesis/images/topography.ps <<END<br/>88 37 14 0 5 LM [1]<br/>92 33 14 0 5 LM [2]<br/>89 30 14 0 5 LM [3]<br/>100 29 14 0 5 LM [4]<br/>END<br/># [1]: Kunlung Mt.<br/># [2]: Tangula Mt.<br/># [3]: Niangqen-Tanglha Mt.<br/># [4]: Hengduan Mt.<br/># making and drawing contours<br/>grdcontour ~/Desktop/thesis/auxillary/topo.nc -Jm87.5/32.5/0.6c -Q10000 -L-1000/9000 -C500 -O -K >> ~/Desktop/thesis/images/topography.ps<br/>psscale -D20c/4.5c/9c/1c -Ctopo.cpt -Bp2000:@Topography:/:m: -O >> ~/Desktop/thesis/images/topography.ps<br/><br/># convert format<br/>ps2raster ../images/topography.ps -Tg -P -A<br/><br/># clean up<br/>rm topo.cpt<br/>rm light.nc</pre></div>
